// Generated by CoffeeScript 1.9.3
(function() {
  var copy;

  addEventListener('copy', copy = function(e) {
    var data, end, i, len, line, ref, sel;
    butterfly.bell("copied");
    e.clipboardData.clearData();
    sel = getSelection().toString().replace(/\u00A0/g, ' ').replace(/\u2007/g, 'Â ');
    data = '';
    ref = sel.split('\n');
    for (i = 0, len = ref.length; i < len; i++) {
      line = ref[i];
      if (line.slice(-1) === '\u23CE') {
        end = '';
        line = line.slice(0, -1);
      } else {
        end = '\n';
      }
      data += line.replace(/\s*$/, '') + end;
    }
    e.clipboardData.setData('text/plain', data.slice(0, -1));
    return e.preventDefault();
  });

  addEventListener('paste', function(e) {
    var data;
    butterfly.bell("pasted");
    data = e.clipboardData.getData('text/plain');
    data = data.replace(/\r\n/g, '\n').replace(/\n/g, '\r');
    butterfly.send(data);
    return e.preventDefault();
  });

}).call(this);
